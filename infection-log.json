{"stats":{"totalMutantsCount":32,"killedCount":30,"killedByStaticAnalysisCount":0,"notCoveredCount":0,"escapedCount":2,"errorCount":0,"syntaxErrorCount":0,"skippedCount":0,"ignoredCount":0,"timeOutCount":0,"msi":93.75,"mutationCodeCoverage":100,"coveredCodeMsi":93.75},"escaped":[{"mutator":{"mutatorName":"App\\Mutator\\Security\\StrcmpToEqualityAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcoll($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":64},"diff":"@@ @@\r\n         echo \"Expected: \" . $expected . \"\\n\";\r\n         echo \"Submitted: \" . $submittedToken . \"\\n\";\r\n         \/\/ return hash_equals($expected, $submittedToken);\r\n-        return strcmp($expected, $submittedToken);\r\n+        return strcoll($expected, $submittedToken);\r\n     }\r\n     public function getCSRFToken()\r\n     {","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.e6f73a8b37312edb17be7e1b7dfd0fa5.infection.xml\r\n\r\n..........Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: invalid_token_xyz\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4FD44184B74DF5987785867EB963D9E9A7508A5360A57C2AC4424D07F18E4C69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69x\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nExpected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: wrong_token\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: invalid\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nExpected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: bad_token\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n......Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nExpected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69extra\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18xxxxx\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d\r\n.....Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: a9fde536f8931f8e3e457e315fd138b1cdd07fe09de58ddfe73a8d7bd5e79e0a\r\n.                                 33 \/ 33 (100%)\r\nNotice: fwrite(): Write of 2203 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.051, Memory: 10.00 MB\r\n\r\nOK (33 tests, 212 assertions)"},{"mutator":{"mutatorName":"RandomBytesToOpenSslRandomPseudoBytes","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(openssl_random_pseudo_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":71},"diff":"@@ @@\r\n     {\r\n         $this->unsetToken();\r\n         if (empty($this->session[$this->sessionTokenLabel])) {\r\n-            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\r\n+            $this->session[$this->sessionTokenLabel] = bin2hex(openssl_random_pseudo_bytes($this->tokenLen));\r\n         }\r\n         if ($this->hmac_ip !== false) {\r\n             $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.09e034cfede0d994a44a873cb2765155.infection.xml\r\n\r\n..........Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: invalid_token_xyz\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4FD44184B74DF5987785867EB963D9E9A7508A5360A57C2AC4424D07F18E4C69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69x\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nExpected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: wrong_token\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: invalid\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nExpected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: bad_token\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n......Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nExpected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69extra\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18xxxxx\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d\r\n.....Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: a9fde536f8931f8e3e457e315fd138b1cdd07fe09de58ddfe73a8d7bd5e79e0a\r\n.                                 33 \/ 33 (100%)\r\nNotice: fwrite(): Write of 2203 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.049, Memory: 10.00 MB\r\n\r\nOK (33 tests, 212 assertions)"}],"timeouted":[],"killed":[{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputToLabelHtmlTagMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<label type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<label type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.6cb100f9b19d3f2e4e50b6c52ddb7e27.infection.xml\r\n\r\nF\r\nNotice: fwrite(): Write of 165 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.049, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustBeInputElement\r\nFailed asserting that '<label type=\"hidden\" name=\"token-csrf\" value=12345 \/>' [ASCII](length: 53) contains \"<input\" [ASCII](length: 6).\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:610\r\n\r\nFAILURES!\r\nTests: 1, Assertions: 1, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputToSelectHtmlTagMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<select type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<select type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.e32b79ac814c5820a13fee140df00697.infection.xml\r\n\r\nF\r\nNotice: fwrite(): Write of 165 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.041, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustBeInputElement\r\nFailed asserting that '<select type=\"hidden\" name=\"token-csrf\" value=12345 \/>' [ASCII](length: 54) contains \"<input\" [ASCII](length: 6).\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:610\r\n\r\nFAILURES!\r\nTests: 1, Assertions: 1, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputToButtonHtmlTagMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<button type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<button type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.6667fbcf2783cb0328dc3cdc04d20309.infection.xml\r\n\r\nF\r\nNotice: fwrite(): Write of 164 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.040, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustBeInputElement\r\nFailed asserting that '<button type=\"hidden\" name=\"token-csrf\" value=12345 \/>' [ASCII](length: 54) contains \"<input\" [ASCII](length: 6).\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:610\r\n\r\nFAILURES!\r\nTests: 1, Assertions: 1, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputToTextareaHtmlTagMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<textarea type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<textarea type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.7339dccf6db78d36f7d3a7d41524a67a.infection.xml\r\n\r\nF\r\nNotice: fwrite(): Write of 165 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.039, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustBeInputElement\r\nFailed asserting that '<textarea type=\"hidden\" name=\"token-csrf\" value=12345 \/>' [ASCII](length: 56) contains \"<input\" [ASCII](length: 6).\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:610\r\n\r\nFAILURES!\r\nTests: 1, Assertions: 1, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputToFieldsetHtmlTagMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<fieldset type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<fieldset type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.088c182b670b98819426593e8886266a.infection.xml\r\n\r\nF\r\nNotice: fwrite(): Write of 165 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.051, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustBeInputElement\r\nFailed asserting that '<fieldset type=\"hidden\" name=\"token-csrf\" value=12345 \/>' [ASCII](length: 56) contains \"<input\" [ASCII](length: 6).\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:610\r\n\r\nFAILURES!\r\nTests: 1, Assertions: 1, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"text\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"text\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.643561409086147989149b66030310ec.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.052, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"text\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"password\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"password\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.c54ba39279942947d45fa296bd5be265.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.048, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"password\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"checkbox\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"checkbox\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.1dfd28b8e5c3dd313d68483d65e8a33e.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 231 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.043, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"checkbox\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"radio\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"radio\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.ab200f960b0ad32ed443d1b84befd76d.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.046, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"radio\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"file\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"file\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.4b200afbf28b71960cbd266786599dd2.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.056, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"file\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"submit\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"submit\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.de0ee0b9419014dff62c6ad7df1ee501.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 231 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.044, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"submit\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"reset\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"reset\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.3a0f1f1f4957bf6efafeb289a8758164.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.053, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"reset\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"button\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"button\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.8887ed505f43244f1c87d244cc01c674.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.047, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"button\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"number\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"number\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.8ea726f1d59aaed2d65e8f1911478ee5.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.045, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"number\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"date\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"date\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.6d812114bd990f9de2270270e05f4a80.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 232 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.060, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"date\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"email\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"email\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.cad21b526d234637f375940a8fb8031e.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 231 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.059, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"email\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Html\\InputHiddenTypeAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"url\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":43},"diff":"@@ @@\r\n     public function insertHiddenToken()\r\n     {\r\n         \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\r\n-        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n+        $hidden = \"<input type=\\\"url\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\r\n         return $hidden;\r\n     }\r\n     public function validateCSRFToken($submittedToken)","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.e6796bfa3faa1d4adb352053d710ae30.infection.xml\r\n\r\n.F\r\nNotice: fwrite(): Write of 231 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.067, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testHiddenTokenMustHaveTypeHidden\r\nFailed asserting that '<input type=\"url\" name=\"token-csrf\" value=12345 \/>' matches PCRE pattern \"\/type=[\"']hidden[\"']\/\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:624\r\n\r\nFAILURES!\r\nTests: 2, Assertions: 8, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\StrcmpToEqualityAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return $expected === $submittedToken;\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":64},"diff":"@@ @@\r\n         echo \"Expected: \" . $expected . \"\\n\";\r\n         echo \"Submitted: \" . $submittedToken . \"\\n\";\r\n         \/\/ return hash_equals($expected, $submittedToken);\r\n-        return strcmp($expected, $submittedToken);\r\n+        return $expected === $submittedToken;\r\n     }\r\n     public function getCSRFToken()\r\n     {","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.798bb8591493800c3a9bb6aab7ed41c3.infection.xml\r\n\r\n..........Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nF\r\nNotice: fwrite(): Write of 833 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.065, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testValidateCSRFTokenReturnsStrictBoolean\r\nFailed asserting that true is of type int.\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:732\r\n\r\nFAILURES!\r\nTests: 11, Assertions: 40, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\StrcmpToEqualityAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return $expected == $submittedToken;\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":64},"diff":"@@ @@\r\n         echo \"Expected: \" . $expected . \"\\n\";\r\n         echo \"Submitted: \" . $submittedToken . \"\\n\";\r\n         \/\/ return hash_equals($expected, $submittedToken);\r\n-        return strcmp($expected, $submittedToken);\r\n+        return $expected == $submittedToken;\r\n     }\r\n     public function getCSRFToken()\r\n     {","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.2650d369868d8d6e531f97a7dae95473.infection.xml\r\n\r\n..........Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nF\r\nNotice: fwrite(): Write of 833 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.065, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testValidateCSRFTokenReturnsStrictBoolean\r\nFailed asserting that true is of type int.\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:732\r\n\r\nFAILURES!\r\nTests: 11, Assertions: 40, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\StrcmpToEqualityAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return hash_equals($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":64},"diff":"@@ @@\r\n         echo \"Expected: \" . $expected . \"\\n\";\r\n         echo \"Submitted: \" . $submittedToken . \"\\n\";\r\n         \/\/ return hash_equals($expected, $submittedToken);\r\n-        return strcmp($expected, $submittedToken);\r\n+        return hash_equals($expected, $submittedToken);\r\n     }\r\n     public function getCSRFToken()\r\n     {","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.82e85e9c22c82b3cffda2b6c62acb801.infection.xml\r\n\r\n..........Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nF\r\nNotice: fwrite(): Write of 833 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.060, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testValidateCSRFTokenReturnsStrictBoolean\r\nFailed asserting that true is of type int.\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:732\r\n\r\nFAILURES!\r\nTests: 11, Assertions: 40, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\StrcmpToEqualityAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcasecmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":64},"diff":"@@ @@\r\n         echo \"Expected: \" . $expected . \"\\n\";\r\n         echo \"Submitted: \" . $submittedToken . \"\\n\";\r\n         \/\/ return hash_equals($expected, $submittedToken);\r\n-        return strcmp($expected, $submittedToken);\r\n+        return strcasecmp($expected, $submittedToken);\r\n     }\r\n     public function getCSRFToken()\r\n     {","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.660026bdc042d93abdbc898656211dc5.infection.xml\r\n\r\n..........Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: invalid_token_xyz\r\nF\r\nNotice: fwrite(): Write of 980 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.072, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testValidateCSRFTokenMismatchReturnsFalse\r\nFailed asserting that -53 is identical to -1.\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:752\r\n\r\nFAILURES!\r\nTests: 13, Assertions: 45, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\StrcmpToEqualityAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return levenshtein($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":64},"diff":"@@ @@\r\n         echo \"Expected: \" . $expected . \"\\n\";\r\n         echo \"Submitted: \" . $submittedToken . \"\\n\";\r\n         \/\/ return hash_equals($expected, $submittedToken);\r\n-        return strcmp($expected, $submittedToken);\r\n+        return levenshtein($expected, $submittedToken);\r\n     }\r\n     public function getCSRFToken()\r\n     {","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.b620abd829c6d8191b675a5a0dfdc4d2.infection.xml\r\n\r\n..........Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\n.Expected: 4fd44184b74df5987785867eb963d9e9a7508a5360a57c2ac4424d07f18e4c69\r\nSubmitted: invalid_token_xyz\r\nF\r\nNotice: fwrite(): Write of 979 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.079, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testValidateCSRFTokenMismatchReturnsFalse\r\nFailed asserting that 62 is identical to -1.\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:752\r\n\r\nFAILURES!\r\nTests: 13, Assertions: 45, Failures: 1."},{"mutator":{"mutatorName":"RandomBytesToRandomInt","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_int(0, $this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":71},"diff":"@@ @@\r\n     {\r\n         $this->unsetToken();\r\n         if (empty($this->session[$this->sessionTokenLabel])) {\r\n-            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\r\n+            $this->session[$this->sessionTokenLabel] = bin2hex(random_int(0, $this->tokenLen));\r\n         }\r\n         if ($this->hmac_ip !== false) {\r\n             $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.0dc82dbdba4da50fc2d048e0f9b7ddd3.infection.xml\r\n\r\n.......F\r\nNotice: fwrite(): Write of 616 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.063, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenUniqueness\r\nFailed asserting that actual size 93 matches expected size 128.\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:701\r\n\r\nFAILURES!\r\nTests: 8, Assertions: 33, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\RandomBytesToRandMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(rand(0, $this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":71},"diff":"@@ @@\r\n     {\r\n         $this->unsetToken();\r\n         if (empty($this->session[$this->sessionTokenLabel])) {\r\n-            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\r\n+            $this->session[$this->sessionTokenLabel] = bin2hex(rand(0, $this->tokenLen));\r\n         }\r\n         if ($this->hmac_ip !== false) {\r\n             $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.beeb23cebb65f922fcee06196e52068c.infection.xml\r\n\r\n.......F\r\nNotice: fwrite(): Write of 617 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.073, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenUniqueness\r\nFailed asserting that actual size 93 matches expected size 128.\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:701\r\n\r\nFAILURES!\r\nTests: 8, Assertions: 33, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\HashHmacAlgoAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac('md5', $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":91},"diff":"@@ @@\r\n         \/\/based on\r\n         \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\r\n         $message = \"12345!\" . $token;\r\n-        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\r\n+        $hashHmac = \\hash_hmac('md5', $message, $this->hmacData);\r\n         \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\r\n         return $hashHmac;\r\n     }\r\n }","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.22783e7d49f6f0cc6f190bff8362d8eb.infection.xml\r\n\r\n......F\r\nNotice: fwrite(): Write of 566 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.062, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenHasCorrectFormat\r\nFailed asserting that 'c679c26ed60dc9f5127d7b39b0f44ecd' matches PCRE pattern \"\/^[0-9a-f]{64}$\/i\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:687\r\n\r\nFAILURES!\r\nTests: 7, Assertions: 31, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\HashHmacAlgoAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac('SHA-1', $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":91},"diff":"@@ @@\r\n         \/\/based on\r\n         \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\r\n         $message = \"12345!\" . $token;\r\n-        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\r\n+        $hashHmac = \\hash_hmac('SHA-1', $message, $this->hmacData);\r\n         \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\r\n         return $hashHmac;\r\n     }\r\n }","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.2f5b98336edae5c9a729b6d277bf2aef.infection.xml\r\n\r\n......E\r\nNotice: fwrite(): Write of 569 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.099, Memory: 12.00 MB\r\n\r\nThere was 1 error:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenHasCorrectFormat\r\nValueError: hash_hmac(): Argument #1 ($algo) must be a valid cryptographic hashing algorithm\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:84\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:66\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:684\r\n\r\nERRORS!\r\nTests: 7, Assertions: 29, Errors: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\HashHmacAlgoAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac('SHA-256', $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":91},"diff":"@@ @@\r\n         \/\/based on\r\n         \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\r\n         $message = \"12345!\" . $token;\r\n-        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\r\n+        $hashHmac = \\hash_hmac('SHA-256', $message, $this->hmacData);\r\n         \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\r\n         return $hashHmac;\r\n     }\r\n }","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.45559cbc6e2ad04d8cf93153613bae93.infection.xml\r\n\r\n......E\r\nNotice: fwrite(): Write of 566 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.057, Memory: 12.00 MB\r\n\r\nThere was 1 error:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenHasCorrectFormat\r\nValueError: hash_hmac(): Argument #1 ($algo) must be a valid cryptographic hashing algorithm\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:84\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:66\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:684\r\n\r\nERRORS!\r\nTests: 7, Assertions: 29, Errors: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\HashHmacAlgoAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac('SHA-512', $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":91},"diff":"@@ @@\r\n         \/\/based on\r\n         \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\r\n         $message = \"12345!\" . $token;\r\n-        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\r\n+        $hashHmac = \\hash_hmac('SHA-512', $message, $this->hmacData);\r\n         \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\r\n         return $hashHmac;\r\n     }\r\n }","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.1f0855b5edbf6659fe4d66cb222f36d7.infection.xml\r\n\r\n......E\r\nNotice: fwrite(): Write of 566 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.056, Memory: 12.00 MB\r\n\r\nThere was 1 error:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenHasCorrectFormat\r\nValueError: hash_hmac(): Argument #1 ($algo) must be a valid cryptographic hashing algorithm\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:84\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:66\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:684\r\n\r\nERRORS!\r\nTests: 7, Assertions: 29, Errors: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\HashHmacAlgoAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac('Whirlpool', $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":91},"diff":"@@ @@\r\n         \/\/based on\r\n         \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\r\n         $message = \"12345!\" . $token;\r\n-        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\r\n+        $hashHmac = \\hash_hmac('Whirlpool', $message, $this->hmacData);\r\n         \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\r\n         return $hashHmac;\r\n     }\r\n }","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.9fbea3abe4d247b56359fbf8ffb40258.infection.xml\r\n\r\n......F\r\nNotice: fwrite(): Write of 566 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.060, Memory: 12.00 MB\r\n\r\nThere was 1 failure:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenHasCorrectFormat\r\nFailed asserting that '8ab7d23ffa1b6ad9b990a9bf0d1eeecd865c8d597a717686b539c64499fe02a837c172c478d2861642540f4932984d90e6f60c8908ecafde7121301131ce056f' matches PCRE pattern \"\/^[0-9a-f]{64}$\/i\".\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:687\r\n\r\nFAILURES!\r\nTests: 7, Assertions: 31, Failures: 1."},{"mutator":{"mutatorName":"App\\Mutator\\Security\\HashHmacAlgoAlternativesMutator","originalSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","mutatedSourceCode":"<?php\n\nnamespace App;\n\nclass UserProfileRead\n{\n    private $formTokenLabel = 'eg-csrf-token-label';\n    public $sessionTokenLabel = 'eG_CSRF_TOKEN_SESS_IDx';\n    public $tokenLen = 200;\n    private $post = [];\n    public $session = [];\n    private $server = [];\n    private $excludeUrl = [];\n    public $hashAlgo = 'sha256';\n    public $hmac_ip = true;\n    public $hmacData = 'ABCeNBHVe3kmAqvU2s7yyuJSF2gpxKLC&*#@!$~%';\n    \/*public function getProfileByUserId(string $userId): string\n        {\n            \/\/ \u2757 Vulnerable: does not check ownership or session\n            $base = __DIR__ . '\/..\/vulnerable_files\/users\/';\n            $path = realpath($base . $userId . '\/profile.txt');\n    \n            if ($path && str_starts_with($path, realpath($base))) {\n                return file_get_contents($path);\n            }\n    \n            return 'Profile not found or access denied';\n        }*\/\n    \/\/FUNGSI CSRF\n    public function xssafe($data, $encoding = 'UTF-8')\n    {\n        return htmlspecialchars($data, ENT_QUOTES | ENT_HTML401, $encoding);\n    }\n    public function insertHiddenToken()\n    {\n        \/\/$hidden = \"<!--\\n--><input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=\\\"\" . $_COOKIE[\"PHPSESSID\"] . \"\\\"\" . \" \/>\";\n        $hidden = \"<input type=\\\"hidden\\\"\" . \" name=\\\"token-csrf\\\"\" . \" value=12345 \/>\";\n        return $hidden;\n    }\n    public function validateCSRFToken($submittedToken)\n    {\n        $this->session[$this->sessionTokenLabel] = 'eG_CSRF_TOKEN_SESS_IDx';\n        if (!isset($this->session[$this->sessionTokenLabel])) {\n            \/\/ CSRF Token not found\n            return false;\n        }\n        if ($this->hmac_ip !== false) {\n            \/\/echo \"HMAC IP is true\\n\";\n            $expected = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            \/\/echo \"HMAC IP is false\\n\";\n            $expected = $this->session[$this->sessionTokenLabel];\n        }\n        echo \"Expected: \" . $expected . \"\\n\";\n        echo \"Submitted: \" . $submittedToken . \"\\n\";\n        \/\/ return hash_equals($expected, $submittedToken);\n        return strcmp($expected, $submittedToken);\n    }\n    public function getCSRFToken()\n    {\n        $this->unsetToken();\n        if (empty($this->session[$this->sessionTokenLabel])) {\n            $this->session[$this->sessionTokenLabel] = bin2hex(random_bytes($this->tokenLen));\n        }\n        if ($this->hmac_ip !== false) {\n            $token = $this->hMacWithIp($this->session[$this->sessionTokenLabel]);\n        } else {\n            $token = $this->session[$this->sessionTokenLabel];\n        }\n        return $token;\n    }\n    public function unsetToken()\n    {\n        if (!empty($this->session[$this->sessionTokenLabel])) {\n            unset($this->session[$this->sessionTokenLabel]);\n        }\n    }\n    \/\/F2\n    public function hMacWithIp($token)\n    {\n        \/\/based on\n        \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\n        $message = \"12345!\" . $token;\n        $hashHmac = \\hash_hmac('RIPEMD-160', $message, $this->hmacData);\n        \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\n        return $hashHmac;\n    }\n}","originalFilePath":"C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php","originalStartLine":91},"diff":"@@ @@\r\n         \/\/based on\r\n         \/\/$message = $_COOKIE[\"PHPSESSID\"]. \"!\" .$token;\r\n         $message = \"12345!\" . $token;\r\n-        $hashHmac = \\hash_hmac($this->hashAlgo, $message, $this->hmacData);\r\n+        $hashHmac = \\hash_hmac('RIPEMD-160', $message, $this->hmacData);\r\n         \/\/echo \"HMAC: \" . $hashHmac . \"\\n\";\r\n         return $hashHmac;\r\n     }\r\n }","processOutput":"PHPUnit 10.5.47 by Sebastian Bergmann and contributors.\r\n\r\nRuntime:       PHP 8.3.29\r\nConfiguration: C:\\Users\\Abdurrasyid\\AppData\\Local\\Temp\\infection\\phpunitConfiguration.d18976fc62d0b12a96c1abfa46ced87b.infection.xml\r\n\r\n......E\r\nNotice: fwrite(): Write of 566 bytes failed with errno=13 Permission denied in C:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\vendor\\infection\\include-interceptor\\src\\IncludeInterceptor.php on line 359\r\n\r\n\r\nTime: 00:00.055, Memory: 12.00 MB\r\n\r\nThere was 1 error:\r\n\r\n1) Tests\\CSRFChainMCPTest::testCSRFTokenHasCorrectFormat\r\nValueError: hash_hmac(): Argument #1 ($algo) must be a valid cryptographic hashing algorithm\r\n\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:84\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\src\\UserProfileRead.php:66\r\nC:\\Users\\Abdurrasyid\\Institut Teknologi Bandung\\YA Research Topics - x Mutation Security - Abdurrasyid - Documents\\bhn eks\\Bahan Eks Cybersecurity\\tests\\CSRFChainMCPTest.php:684\r\n\r\nERRORS!\r\nTests: 7, Assertions: 29, Errors: 1."}],"killedByStaticAnalysis":[],"errored":[],"syntaxErrors":[],"uncovered":[],"ignored":[]}